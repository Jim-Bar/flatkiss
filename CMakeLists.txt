cmake_minimum_required(VERSION 3.22)

project(FlatKiss)

# Enable clang-tidy for all the targets using the .clang-tidy file.
set(CMAKE_CXX_CLANG_TIDY clang-tidy)

configure_file(
    src/main.hpp.in
    src/main.hpp
)

# Files generated by `configure_file()` are put in this directory, so include it.
include_directories(${CMAKE_CURRENT_BINARY_DIR}/src)

find_package(SDL2 REQUIRED)
include_directories(${SDL2_INCLUDE_DIRS})

# List of the targets to build.
set(EXECUTABLE_NAME ${PROJECT_NAME})
set(RENDERER_NAME ${EXECUTABLE_NAME}-renderer)

# Including header files in the targets because from Modern CMake: "The headers will be, for most intents and purposes,
# ignored; the only reason to list them is to get them to show up in IDEs". Refer to:
# https://cliutils.gitlab.io/modern-cmake/chapters/basics.html

add_executable(${EXECUTABLE_NAME}
    src/action.cpp
    src/action.hpp
    src/action_sprite_mapper.cpp
    src/action_sprite_mapper.hpp
    src/animation.cpp
    src/animation.hpp
    src/animation_player.cpp
    src/animation_player.hpp
    src/cardinal_direction.cpp
    src/cardinal_direction.hpp
    src/character.cpp
    src/character.hpp
    src/character_controller.cpp
    src/character_controller.hpp
    src/collider.cpp
    src/collider.hpp
    src/configuration.cpp
    src/configuration.hpp
    src/ellipse.cpp
    src/ellipse.hpp
    src/level.cpp
    src/level.hpp
    src/main.cpp
    src/main.hpp
    src/navigator.cpp
    src/navigator.hpp
    src/position.cpp
    src/position.hpp
    src/positioned_ellipse.cpp
    src/positioned_ellipse.hpp
    src/positioned_rectangle.cpp
    src/positioned_rectangle.hpp
    src/positioned_solid.cpp
    src/positioned_solid.hpp
    src/rectangle.cpp
    src/rectangle.hpp
    src/solid.cpp
    src/solid.hpp
    src/spriteset.cpp
    src/spriteset.hpp
    src/tile_solid_mapper.cpp
    src/tile_solid_mapper.hpp
    src/vector.cpp
    src/vector.hpp
)
target_link_libraries(${EXECUTABLE_NAME} ${RENDERER_NAME})

add_library(${RENDERER_NAME} STATIC
    src/keyboard_state.cpp
    src/keyboard_state.hpp
    src/renderer.cpp
    src/renderer.hpp
    src/texture.cpp
    src/texture.hpp
)
target_link_libraries(${RENDERER_NAME} ${SDL2_LIBRARIES})

# Setting the C++ version, from Modern CMake:
# https://cliutils.gitlab.io/modern-cmake/chapters/features/cpp11.html
target_compile_features(${EXECUTABLE_NAME} PUBLIC cxx_std_20)
set_target_properties(${EXECUTABLE_NAME} PROPERTIES CXX_EXTENSIONS OFF)
target_compile_features(${RENDERER_NAME} PUBLIC cxx_std_20)
set_target_properties(${RENDERER_NAME} PROPERTIES CXX_EXTENSIONS OFF)
